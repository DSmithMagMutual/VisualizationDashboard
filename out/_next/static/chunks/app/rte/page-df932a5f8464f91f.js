(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[416],{356:(e,t,r)=>{Promise.resolve().then(r.bind(r,1207))},1207:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>Q});var o=r(5155),a=r(2115),s=r(4581),i=r(700),n=r(7744),l=r(7918),d=r(804),c=r(4572),f=r(5222),u=r(1218),h=r(6632),g=r(4426),x=r(1101),p=r(9267),m=r(5715),b=r(4915),y=r(835),j=r(8534),A=r(7262),v=r(3127),k=r(3729),S=r(9990),w=r(2663),C=r(4802),W=r(5129),E=r(7350),I=r(4523),D=r(6115),P=r(6475),R=r(4128);async function O(e){let t=0,r=[],o=0,a=new Set;do{let s=await fetch("/api/jira?endpoint=search&jql=project=".concat(e," ORDER BY rank ASC&startAt=").concat(t,"&maxResults=").concat(1e3,"&fields=summary,status,issuetype,parent,customfield_10014,assignee,customfield_10001"));if(!s.ok)throw Error("Failed to fetch issues from Jira");let i=await s.json();i.issues&&(r=r.concat(i.issues),i.issues.forEach(e=>{var t;let r=null==(t=e.fields.parent)?void 0:t.key;r&&a.add(r)})),o=i.total||0,t+=1e3}while(r.length<o);let s=new Set(r.map(e=>e.key)),i=Array.from(a).filter(e=>!s.has(e));if(i.length>0)for(let e=0;e<i.length;e+=50){let t=i.slice(e,e+50),o="key in (".concat(t.map(e=>"'".concat(e,"'")).join(","),")"),a=await fetch("/api/jira?endpoint=search&jql=".concat(encodeURIComponent(o),"&fields=summary,status,issuetype,parent,customfield_10014,assignee,customfield_10001"));if(!a.ok)continue;let s=await a.json();s.issues&&(r=r.concat(s.issues))}return{issues:r,total:r.length}}async function F(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],r=arguments.length>2?arguments[2]:void 0,o=await fetch("/api/jira-cache?projectKey=".concat(e,"&useCache=").concat(t?"1":"0"));if(o.ok){let e=await o.json();return r&&Array.isArray(e.issues)&&r(e.issues),e}if(404===o.status){let t=await O(e);return await fetch("/api/jira-cache",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({issues:t.issues})}),r&&Array.isArray(t.issues)&&r(t.issues),t}throw Error("Failed to fetch issues (cache API)")}let B=(0,a.createContext)(null);function T(){let e=(0,a.useContext)(B);if(!e)throw Error("useBoard must be used within a BoardProvider");return e}function z(e){let{children:t}=e,[r,s]=(0,a.useState)([{name:"Hogwarts Express",id:1070,projectKey:"ADVICE"},{name:"Feature Freight",id:1164,projectKey:"ADVICE"},{name:"CAD",id:1069,projectKey:"ADVICE"}]),[i,n]=(0,a.useState)([{name:"Hogwarts Express",id:1070,projectKey:"ADVICE"}]),l=i.length>0?i[0]:{name:"",id:0,projectKey:""};return(0,o.jsx)(B.Provider,{value:{boards:r,selectedBoards:i,activeBoard:l,setSelectedBoards:n,setActiveBoard:e=>{n([e])},addBoard:e=>{s(t=>[...t,e])},toggleBoard:e=>{n(t=>t.some(t=>t.id===e.id)?t.filter(t=>t.id!==e.id):[...t,e])}},children:t})}var N=r(4211),K=r(7916),_=r(7581),M=r(3306);r(1687);let H=e=>100===e?"#198754":e>=75?"#0d6efd":e>=50?"#fd7e14":e>=25?"#ffc107":"#dc3545",L=e=>"done"===e?(0,o.jsx)(C.A,{sx:{color:"#198754"},fontSize:"small","aria-label":"Done"}):"indeterminate"===e?(0,o.jsx)(W.A,{sx:{color:"#fd7e14"},fontSize:"small","aria-label":"In Progress"}):(0,o.jsx)(E.A,{sx:{color:"#dc3545"},fontSize:"small","aria-label":"To Do"}),U=e=>"done"===e?"Done":"indeterminate"===e?"In Progress":"To Do",G=e=>"".concat("https://magmutual.atlassian.net","/browse/").concat(e),J={};function V(e){let{onTeamsUpdate:t,selectedTeams:r}=e,{selectedBoards:C,activeBoard:W}=T(),[E,O]=(0,a.useState)([]),[B,z]=(0,a.useState)(!0),[N,K]=(0,a.useState)(null),[_,M]=(0,a.useState)({}),[V,X]=(0,a.useState)(!1),[Y,Q]=(0,a.useState)(!1),[Z,$]=(0,a.useState)(!1),[ee,et]=(0,a.useState)(null),[er,eo]=(0,a.useState)([]),[ea,es]=(0,a.useState)([]),[ei,en]=(0,a.useState)([]),[el,ed]=(0,a.useState)("feature"),ec={"OG Team":"#6C63FF"};function ef(e){if(ec[e])return ec[e];let t=0;for(let r=0;r<e.length;r++)t=e.charCodeAt(r)+((t<<5)-t);let r=(0xffffff&t).toString(16).toUpperCase();return"#"+"00000".substring(0,6-r.length)+r}function eu(e){let t=new Set;return e.team&&t.add(e.team),e.stories.forEach(e=>{e.team&&t.add(e.team)}),0===t.size&&t.add("Other"),Array.from(t)}if((0,a.useEffect)(()=>{let e=new Set(C.map(e=>"".concat(e.projectKey,"-").concat(e.id)));Object.keys(J).forEach(t=>{e.has(t)||delete J[t]}),(async()=>{try{if(z(!0),K(null),0===C.length){K("No boards selected"),z(!1);return}let e=setTimeout(()=>{K("Request timed out. Please check your Jira configuration."),z(!1)},3e4),t=[],r={issues:[]},o=new Set;for(let e of C){let a=Date.now(),s="".concat(e.projectKey,"-").concat(e.id);if(J[s]&&a-J[s].timestamp<3e5){t.push(...J[s].data);continue}console.log("Fetching feature progress for board:",e.name,"project:",e.projectKey);try{let a=await F(e.projectKey);if(a.issues&&(r.issues.push(...a.issues),a.issues.forEach(e=>o.add(e.fields.issuetype.name))),!a.issues){console.warn("No issues found for board: ".concat(e.name));continue}let s={};a.issues.forEach(e=>{s[e.id]=e});let i=[],n={},l={};a.issues.forEach(e=>{var t,r,o;let a=(null==(t=e.fields.parent)?void 0:t.id)||e.fields.customfield_10014;a&&e.fields.parent&&(l[a]=e.fields.parent);let d={id:e.id,key:e.key,summary:e.fields.summary,status:e.fields.status.name,statusCategory:e.fields.status.statusCategory.key,assignee:(null==(r=e.fields.assignee)?void 0:r.displayName)||(null==(o=e.fields.assignee)?void 0:o.emailAddress),team:(()=>{let t=e.fields.customfield_10001;return"object"==typeof t&&(null==t?void 0:t.name)?t.name:"string"==typeof t&&t?t:"Other"})()};a&&s[a]?(n[a]||(n[a]=[]),n[a].push(d)):i.push({id:e.id,originalId:e.id,key:e.key,summary:e.fields.summary,status:e.fields.status.name,statusCategory:e.fields.status.statusCategory.key,stories:[],completedStories:0,totalStories:0,progressPercentage:0,team:(()=>{let t=e.fields.customfield_10001;return"object"==typeof t&&(null==t?void 0:t.name)?t.name:"string"==typeof t&&t?t:"Other"})(),issuetype:e.fields.issuetype.name,ghost:!1})}),Object.entries(l).forEach(e=>{let[t,r]=e;if(!s[t]&&!i.some(e=>e.id===t)){var o,a,l,d,c,f,u,h;i.push({id:t,originalId:t,key:r.key,summary:(null==(o=r.fields)?void 0:o.summary)||"(No summary)",status:(null==(l=r.fields)||null==(a=l.status)?void 0:a.name)||"Unknown",statusCategory:(null==(f=r.fields)||null==(c=f.status)||null==(d=c.statusCategory)?void 0:d.key)||"indeterminate",stories:n[t]||[],completedStories:(n[t]||[]).filter(e=>"done"===e.statusCategory).length,totalStories:(n[t]||[]).length,progressPercentage:n[t]&&n[t].length>0?Math.round(n[t].filter(e=>"done"===e.statusCategory).length/n[t].length*100):0,team:"Other",issuetype:(null==(h=r.fields)||null==(u=h.issuetype)?void 0:u.name)||"Unknown",ghost:!0})}}),i.forEach(e=>{e.stories=n[e.id]||e.stories||[],e.totalStories=e.stories.length,e.completedStories=e.stories.filter(e=>"done"===e.statusCategory).length,e.progressPercentage=e.totalStories>0?Math.round(e.completedStories/e.totalStories*100):0}),t.push(...i),J["".concat(e.projectKey,"-").concat(e.id)]={data:i,timestamp:Date.now()}}catch(t){console.error("Error fetching data for board ".concat(e.name,":"),t)}}clearTimeout(e),es(Array.from(o)),en(Array.from(o)),et(r);let a=new Set,s=t.filter(e=>!(e.originalId&&a.has(e.originalId))&&(e.originalId&&a.add(e.originalId),!0)).sort((e,t)=>e.progressPercentage-t.progressPercentage);O(s),z(!1)}catch(e){console.error("FeatureProgressWidget error:",e),K(e instanceof Error?e.message:"Failed to fetch feature progress"),z(!1)}})()},[C]),(0,a.useEffect)(()=>{let e=new Set;E.forEach(t=>{t.team&&e.add(t.team),t.stories.forEach(t=>{t.team&&e.add(t.team)})}),0===e.size&&e.add("Other");let r=Array.from(e);eo(r),t&&t(r),console.log("DEBUG: Aggregated teams:",r),console.log("DEBUG: Features:",E),console.log("DEBUG: Raw Jira data:",ee)},[E,t]),B)return(0,o.jsx)(u.A,{sx:{mb:4,p:2,maxWidth:1350,mx:"auto",bgcolor:"#f8f9fa",border:"1px solid #e9ecef"},children:(0,o.jsxs)(h.A,{sx:{p:3,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:300},children:[(0,o.jsx)(g.A,{sx:{color:"#0d6efd",mb:2},size:40,"aria-label":"Loading"}),(0,o.jsx)(i.A,{variant:"body2",sx:{fontWeight:600,color:"#212529"},children:"Loading feature progressâ€¦"}),(0,o.jsxs)(i.A,{variant:"caption",sx:{mt:1,color:"#6c757d"},children:["Boards: ",C.map(e=>"".concat(e.name," (").concat(e.projectKey,")")).join(", ")||"None selected"]})]})});if(N)return(0,o.jsx)(u.A,{sx:{mb:4,p:2,maxWidth:1350,mx:"auto",bgcolor:"#f8f9fa",border:"1px solid #e9ecef"},children:(0,o.jsxs)(h.A,{sx:{p:3},children:[(0,o.jsx)(i.A,{variant:"h6",sx:{color:"#dc3545",fontWeight:700},gutterBottom:!0,tabIndex:0,children:"Feature Progress (Epics)"}),(0,o.jsx)(i.A,{variant:"body2",sx:{color:"#212529",fontWeight:500},gutterBottom:!0,children:N}),(0,o.jsx)(i.A,{variant:"caption",sx:{color:"#6c757d"},children:"Make sure your Jira environment variables are configured correctly."})]})});let eh=E;V&&(eh=eh.filter(e=>e.progressPercentage<100)),Y&&(eh=eh.filter(e=>e.totalStories>0)),r&&r.length>0&&(eh=eh.filter(e=>eu(e).some(e=>r.includes(e))).map(e=>({...e,stories:e.stories.filter(e=>r.includes(e.team||"Other"))}))),ei.length>0&&(eh=eh.filter(e=>ei.includes(e.issuetype)));let eg=E.length>0?Math.round(E.filter(e=>100===e.progressPercentage).length/E.length*100):0,ex=(0,o.jsxs)(s.A,{mt:2,mb:3,children:[(0,o.jsx)(i.A,{variant:"subtitle1",sx:{color:"#212529",fontWeight:600,mb:1},children:"Issue Types:"}),(0,o.jsx)(n.A,{multiple:!0,value:ei,onChange:e=>en("string"==typeof e.target.value?e.target.value.split(","):e.target.value),input:(0,o.jsx)(l.A,{label:"Issue Types"}),renderValue:e=>(0,o.jsx)(s.A,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:e.map(e=>(0,o.jsx)(x.A,{label:e},e))}),sx:{minWidth:240,background:"#fff",borderRadius:2},children:ea.map(e=>(0,o.jsxs)(d.A,{value:e,children:[(0,o.jsx)(c.A,{checked:ei.indexOf(e)>-1}),(0,o.jsx)(f.A,{primary:e})]},e))})]});return(0,o.jsxs)(u.A,{sx:{mb:4,p:2,maxWidth:1350,mx:"auto",bgcolor:"#f8f9fa",border:"1px solid #e9ecef"},children:[(0,o.jsxs)(h.A,{children:[(0,o.jsx)(s.A,{sx:{mb:2},children:(0,o.jsxs)(p.A,{value:el,onChange:(e,t)=>ed(t),"aria-label":"Widget Tabs",children:[(0,o.jsx)(m.A,{label:"Feature Progress",value:"feature"}),(0,o.jsx)(m.A,{label:"Dependency Graph",value:"dependency"})]})}),"feature"===el?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(s.A,{sx:{bgcolor:"#ffffff",borderRadius:2,p:2,mb:3,border:"1px solid #dee2e6",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[(0,o.jsxs)(s.A,{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2,children:[(0,o.jsxs)(s.A,{children:[(0,o.jsx)(i.A,{variant:"h6",sx:{fontWeight:700,color:"#212529"},children:"Feature Progress"}),(0,o.jsxs)(i.A,{variant:"caption",sx:{color:"#6c757d",fontWeight:500},children:["Boards: ",C.map(e=>"".concat(e.name," (").concat(e.projectKey,")")).join(", ")]})]}),(0,o.jsxs)(s.A,{display:"flex",alignItems:"center",gap:2,children:[(0,o.jsx)(b.A,{control:(0,o.jsx)(y.A,{checked:V,onChange:e=>X(e.target.checked)}),label:(0,o.jsx)(i.A,{sx:{color:"#212529",fontWeight:500},children:"Hide Completed"})}),(0,o.jsx)(b.A,{control:(0,o.jsx)(y.A,{checked:Y,onChange:e=>Q(e.target.checked)}),label:(0,o.jsx)(i.A,{sx:{color:"#212529",fontWeight:500},children:"Hide Empty Features"})}),(0,o.jsx)(j.A,{onClick:()=>{let e={};E.forEach(t=>{e[t.id]=!0}),M(e)},startIcon:(0,o.jsx)(I.A,{}),sx:{color:"#0d6efd",fontWeight:500,border:"1px solid #0d6efd","&:hover":{backgroundColor:"#0d6efd",color:"#ffffff"}},children:"Expand All"}),(0,o.jsx)(j.A,{onClick:()=>{M({})},startIcon:(0,o.jsx)(D.A,{}),sx:{color:"#0d6efd",fontWeight:500,border:"1px solid #0d6efd","&:hover":{backgroundColor:"#0d6efd",color:"#ffffff"}},children:"Collapse All"})]})]}),ex,(0,o.jsxs)(s.A,{display:"flex",alignItems:"center",gap:2,mb:2,sx:{flexWrap:"wrap",rowGap:1},children:[(0,o.jsx)(i.A,{variant:"subtitle2",sx:{color:"#212529",fontWeight:600,mr:1,mb:.5},children:"Teams:"}),er.map(e=>(0,o.jsx)(x.A,{label:e,avatar:(0,o.jsx)("span",{style:{display:"inline-block",width:16,height:16,borderRadius:"50%",background:ef(e),border:"1.5px solid #fff",boxShadow:"0 0 0 1px #dee2e6"}}),sx:{bgcolor:"#f3f4f6",color:"#212529",fontWeight:500,fontSize:"0.95em",mr:1,mb:.5,height:28}},e))]}),(0,o.jsxs)(s.A,{children:[(0,o.jsxs)(i.A,{variant:"body2",sx:{mb:1,color:"#212529",fontWeight:500},children:["Overall: ",eg,"% of features complete"]}),(0,o.jsx)(A.A,{variant:"determinate",value:eg,sx:{height:12,borderRadius:6,background:"#e9ecef","& .MuiLinearProgress-bar":{background:H(eg)}},"aria-label":"Overall feature progress: ".concat(eg,"% complete")})]})]}),0===eh.length?(0,o.jsx)(i.A,{variant:"body2",sx:{textAlign:"center",py:4,color:"#6c757d",fontWeight:500},children:V&&Y?"No incomplete features with stories found.":V?"No incomplete features found.":Y?"No features with stories found.":"No features found in this project."}):(0,o.jsx)(s.A,{sx:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:3,maxWidth:"100%","@media (max-width: 1400px)":{gridTemplateColumns:"repeat(2, 1fr)"},"@media (max-width: 900px)":{gridTemplateColumns:"1fr"}},children:eh.map(e=>(0,o.jsx)(u.A,{sx:{bgcolor:e.ghost?"#fbeee6":"#ffffff",border:e.ghost?"2px dashed #f4a261":"1px solid #dee2e6","&:hover":{borderColor:e.ghost?"#f4a261":"#adb5bd",boxShadow:"0 2px 8px rgba(0,0,0,0.15)"}},children:(0,o.jsxs)(h.A,{sx:{p:2},children:[(0,o.jsxs)(s.A,{display:"flex",alignItems:"flex-start",justifyContent:"space-between",mb:1,children:[(0,o.jsxs)(s.A,{sx:{flex:1,minWidth:0},children:[(0,o.jsx)(i.A,{variant:"subtitle1",fontWeight:600,sx:{mb:.5},children:(0,o.jsxs)("a",{href:G(e.key),target:"_blank",rel:"noopener noreferrer",style:{color:"#0d6efd",textDecoration:"none",cursor:"pointer",fontWeight:600},onMouseEnter:e=>e.currentTarget.style.textDecoration="underline",onMouseLeave:e=>e.currentTarget.style.textDecoration="none",children:[e.key," ",e.ghost&&(0,o.jsx)("span",{style:{color:"#f4a261",fontWeight:700,marginLeft:6},children:"(ghost)"})]})}),(0,o.jsx)(i.A,{variant:"body2",sx:{fontSize:"0.875rem",lineHeight:1.3,display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis",color:"#495057",fontWeight:400},children:e.summary})]}),(0,o.jsx)(v.A,{"aria-label":_[e.id]?"Collapse feature details":"Expand feature details",onClick:()=>M(t=>({...t,[e.id]:!t[e.id]})),size:"small",sx:{ml:1,flexShrink:0,color:"#0d6efd","&:hover":{backgroundColor:"rgba(13, 110, 253, 0.1)"}},children:_[e.id]?(0,o.jsx)(P.A,{}):(0,o.jsx)(R.A,{})})]}),(0,o.jsxs)(s.A,{display:"flex",alignItems:"center",gap:1,mb:1,children:[(0,o.jsxs)(i.A,{variant:"body2",sx:{fontSize:"0.75rem",color:"#495057",fontWeight:500},children:[e.completedStories,"/",e.totalStories]}),(0,o.jsx)(k.A,{title:U(e.statusCategory),children:L(e.statusCategory)}),(0,o.jsxs)(i.A,{variant:"body2",fontWeight:600,sx:{minWidth:40,textAlign:"right",color:H(e.progressPercentage),fontSize:"0.875rem"},children:[e.progressPercentage,"%"]})]}),(0,o.jsx)(s.A,{display:"flex",alignItems:"center",gap:1,mb:1,children:eu(e).map(e=>(0,o.jsx)(k.A,{title:e,placement:"top",children:(0,o.jsx)("span",{style:{display:"inline-block",width:12,height:12,borderRadius:"50%",background:ef(e||"Other"),border:"1.5px solid #fff",boxShadow:"0 0 0 1px #dee2e6",marginRight:2}})},e))}),(0,o.jsx)(s.A,{display:"flex",alignItems:"center",gap:1,mb:1,children:(0,o.jsx)(A.A,{variant:"determinate",value:e.progressPercentage,sx:{height:8,borderRadius:4,background:"#e9ecef",flex:1,"& .MuiLinearProgress-bar":{background:H(e.progressPercentage)}},"aria-label":"Feature ".concat(e.key," progress: ").concat(e.progressPercentage,"% complete")})}),(0,o.jsx)(S.A,{in:!!_[e.id],timeout:"auto",unmountOnExit:!0,children:(0,o.jsx)(s.A,{sx:{mt:1,pt:1,borderTop:"1px solid #dee2e6",maxHeight:200,overflow:"auto"},children:0===e.stories.length?(0,o.jsx)(i.A,{variant:"body2",sx:{fontSize:"0.75rem",color:"#6c757d",fontWeight:400},children:"No stories linked to this feature."}):e.stories.map((t,r)=>(0,o.jsxs)(s.A,{display:"flex",alignItems:"center",gap:1,mb:.5,children:[(0,o.jsx)(s.A,{display:"flex",alignItems:"center",gap:1,children:(0,o.jsx)(k.A,{title:t.team||"Other",placement:"top",children:(0,o.jsx)("span",{style:{display:"inline-block",width:10,height:10,borderRadius:"50%",background:ef(t.team||"Other"),border:"1.5px solid #fff",boxShadow:"0 0 0 1px #dee2e6",marginRight:1}})},t.team||"Other")}),(0,o.jsx)(i.A,{variant:"body2",fontWeight:500,sx:{fontSize:"0.75rem"},children:(0,o.jsx)("a",{href:G(t.key),target:"_blank",rel:"noopener noreferrer",style:{color:"#0d6efd",textDecoration:"none",cursor:"pointer",fontWeight:600},onMouseEnter:e=>e.currentTarget.style.textDecoration="underline",onMouseLeave:e=>e.currentTarget.style.textDecoration="none",children:t.key})}),(0,o.jsx)(i.A,{variant:"body2",sx:{fontSize:"0.75rem",flex:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:"#495057",fontWeight:400},children:t.summary}),(0,o.jsx)(k.A,{title:U(t.statusCategory),children:L(t.statusCategory)}),t.assignee&&(0,o.jsx)(w.A,{sx:{width:16,height:16,fontSize:10},children:t.assignee[0]})]},"".concat(e.id,"-").concat(t.id,"-").concat(r)))})})]})},e.id))})]}):(0,o.jsxs)(s.A,{sx:{p:2,minHeight:500},children:[(0,o.jsx)(i.A,{variant:"h5",sx:{color:"#0d6efd",fontWeight:700,mb:2},children:"Dependency Graph"}),(0,o.jsx)(q,{features:E})]})]}),(0,o.jsx)(s.A,{display:"flex",justifyContent:"flex-end",px:2,pb:2,children:(0,o.jsx)(j.A,{size:"small",variant:"outlined",onClick:()=>$(e=>!e),sx:{color:"#0d6efd",borderColor:"#0d6efd",fontWeight:500,"&:hover":{backgroundColor:"#0d6efd",color:"#ffffff",borderColor:"#0d6efd"}},children:Z?"Hide Debug Panel":"Show Debug Panel"})}),Z&&(0,o.jsxs)(s.A,{sx:{bgcolor:"#f8f9fa",color:"#212529",p:2,borderRadius:2,maxHeight:400,overflow:"auto",fontSize:12,border:"1px solid #dee2e6"},children:[(0,o.jsx)(i.A,{variant:"subtitle2",sx:{color:"#0d6efd",fontWeight:700,fontSize:"0.875rem"},children:"Raw API Data:"}),(0,o.jsx)("pre",{style:{whiteSpace:"pre-wrap",wordBreak:"break-all",color:"#212529",fontSize:"0.75rem"},children:JSON.stringify(ee,null,2)}),(0,o.jsx)(i.A,{variant:"subtitle2",sx:{color:"#0d6efd",mt:2,fontWeight:700,fontSize:"0.875rem"},children:"Mapped Features:"}),(0,o.jsx)("pre",{style:{whiteSpace:"pre-wrap",wordBreak:"break-all",color:"#212529",fontSize:"0.75rem"},children:JSON.stringify(E,null,2)})]})]})}function q(e){let{features:t}=e,r=[],a=[],i=new Set;return t.forEach((e,t)=>{r.push({id:e.id,data:{label:"".concat(e.key,": ").concat(e.summary)},position:{x:0,y:0+120*t},style:{minWidth:220,background:e.ghost?"#fbeee6":"#fff",border:e.ghost?"2px dashed #f4a261":"1px solid #dee2e6",fontWeight:600}}),i.add(e.id),e.stories.forEach((o,s)=>{let n=o.id;i.has(n)||(r.push({id:n,data:{label:"".concat(o.key,": ").concat(o.summary)},position:{x:300,y:0+120*t+40*s},style:{minWidth:220,background:"#f3f4f6",border:"1px solid #dee2e6"}}),i.add(n)),a.push({id:"".concat(e.id,"->").concat(n),source:e.id,target:n,animated:!1})})}),(0,o.jsx)(s.A,{sx:{width:"100%",height:600,background:"#f8f9fa",borderRadius:2,border:"1px solid #dee2e6"},children:(0,o.jsxs)(N.Gc,{nodes:r,edges:a,fitView:!0,panOnDrag:!0,zoomOnScroll:!0,zoomOnPinch:!0,panOnScroll:!0,elementsSelectable:!1,nodesDraggable:!1,nodesConnectable:!1,edgesFocusable:!1,proOptions:{hideAttribution:!0},children:[(0,o.jsx)(K.V,{color:"#e9ecef",gap:32}),(0,o.jsx)(_.o,{nodeColor:()=>"#6C63FF",nodeStrokeWidth:3,zoomable:!0,pannable:!0}),(0,o.jsx)(M.H,{showInteractive:!0})]})})}function X(e){let{onManualRefresh:t,refreshing:r}=e,{boards:n,selectedBoards:l,toggleBoard:d,addBoard:c}=T(),[f,u]=a.useState(!1),[h,g]=a.useState(""),[x,p]=a.useState(""),[m,b]=a.useState(""),y={1070:"#6C63FF",1164:"#00B894",1069:"#0984E3"};return(0,o.jsxs)(s.A,{display:"flex",alignItems:"center",gap:2,mb:3,children:[(0,o.jsx)(i.A,{variant:"h6",sx:{color:"#212529",fontWeight:700},children:"Boards:"}),(0,o.jsx)(s.A,{display:"flex",flexWrap:"wrap",gap:1,children:n.map(e=>{let t=l.some(t=>t.id===e.id),r=function(e){if(y[e])return y[e];let t=e,r=(0xffffff&(t=(t<<5)-t+12345)).toString(16).toUpperCase();return"#"+"00000".substring(0,6-r.length)+r}(e.id);return(0,o.jsx)("button",{onClick:()=>d(e),style:{padding:"6px 12px",borderRadius:8,background:t?r:"#ffffff",color:t?"#ffffff":"#212529",border:"2.5px solid ".concat(r),fontWeight:600,cursor:"pointer",fontSize:14,boxShadow:t?"0 0 0 2px ".concat(r,"55"):void 0,transition:"box-shadow 0.2s, border 0.2s"},"aria-label":"".concat(t?"Deselect":"Select"," ").concat(e.name),children:e.name},e.id)})}),(0,o.jsx)("button",{onClick:()=>u(!0),style:{marginLeft:8,padding:"6px 12px",borderRadius:8,background:"#6C63FF",color:"#fff",border:"none",fontWeight:600,cursor:"pointer"},"aria-label":"Add board",children:"+ Add Board"}),t&&(0,o.jsx)("button",{onClick:t,disabled:r,style:{marginLeft:8,padding:"6px 16px",borderRadius:8,background:"#0d6efd",color:"#fff",border:"none",fontWeight:600,cursor:r?"not-allowed":"pointer",opacity:r?.6:1},"aria-label":"Manual Refresh",children:r?"Refreshing...":"Manual Refresh"}),f&&(0,o.jsxs)("div",{role:"dialog","aria-modal":"true",style:{background:"#ffffff",color:"#212529",padding:24,borderRadius:12,position:"absolute",top:80,left:"50%",transform:"translateX(-50%)",zIndex:10,minWidth:320,border:"1px solid #dee2e6",boxShadow:"0 4px 12px rgba(0,0,0,0.15)"},children:[(0,o.jsx)(i.A,{variant:"h6",sx:{mb:2,color:"#212529"},children:"Add Board"}),(0,o.jsx)("input",{"aria-label":"Board name",placeholder:"Board name/key",value:h,onChange:e=>g(e.target.value),style:{width:"100%",marginBottom:12,padding:8,borderRadius:6,border:"1px solid #dee2e6",background:"#ffffff",color:"#212529"}}),(0,o.jsx)("input",{"aria-label":"Board ID",placeholder:"Board ID",value:x,onChange:e=>p(e.target.value),style:{width:"100%",marginBottom:12,padding:8,borderRadius:6,border:"1px solid #dee2e6",background:"#ffffff",color:"#212529"}}),(0,o.jsx)("input",{"aria-label":"Project Key",placeholder:"Project Key (e.g., JPP, CAD)",value:m,onChange:e=>b(e.target.value),style:{width:"100%",marginBottom:12,padding:8,borderRadius:6,border:"1px solid #dee2e6",background:"#ffffff",color:"#212529"}}),(0,o.jsxs)(s.A,{display:"flex",gap:2,children:[(0,o.jsx)("button",{onClick:()=>{h&&x&&m&&(c({name:h,id:Number(x),projectKey:m}),g(""),p(""),b(""),u(!1))},style:{padding:"6px 16px",borderRadius:8,background:"#6C63FF",color:"#fff",border:"none",fontWeight:600,cursor:"pointer"},"aria-label":"Save board",children:"Save"}),(0,o.jsx)("button",{onClick:()=>u(!1),style:{padding:"6px 16px",borderRadius:8,background:"#6c757d",color:"#fff",border:"none",fontWeight:600,cursor:"pointer"},"aria-label":"Cancel add board",children:"Cancel"})]})]})]})}function Y(){let[e,t]=a.useState([]),[r,u]=a.useState([]),[h,g]=a.useState(!0),[x,p]=a.useState(!1),m=a.useCallback(e=>{t(e)},[]);a.useEffect(()=>{e.length>0&&0===r.length&&u(e)},[e,r.length]);let b=async()=>{p(!0),await fetch("/api/jira-cache",{method:"DELETE"}),g(!1),setTimeout(()=>g(!0),100),p(!1)},y=(0,o.jsxs)(s.A,{mt:2,mb:3,children:[(0,o.jsx)(i.A,{variant:"subtitle1",sx:{color:"#212529",fontWeight:600,mb:1},children:"Teams:"}),(0,o.jsx)(n.A,{multiple:!0,value:r,onChange:e=>u("string"==typeof e.target.value?e.target.value.split(","):e.target.value),input:(0,o.jsx)(l.A,{label:"Teams"}),renderValue:e=>(0,o.jsx)(s.A,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:e.map(e=>(0,o.jsxs)(s.A,{display:"flex",alignItems:"center",gap:.5,sx:{px:1,py:.5,borderRadius:2,bgcolor:"#f3f4f6"},children:[(0,o.jsx)("span",{style:{display:"inline-block",width:12,height:12,borderRadius:"50%",background:function(e){let t={"OG Team":"#6C63FF"};if(t[e])return t[e];let r=0;for(let t=0;t<e.length;t++)r=e.charCodeAt(t)+((r<<5)-r);let o=(0xffffff&r).toString(16).toUpperCase();return"#"+"00000".substring(0,6-o.length)+o}(e),border:"1.5px solid #fff",boxShadow:"0 0 0 1px #dee2e6",marginRight:4}}),(0,o.jsx)(i.A,{variant:"caption",sx:{color:"#212529",fontWeight:500},children:e})]},e))}),sx:{minWidth:240,background:"#fff",borderRadius:2},children:e.map(e=>(0,o.jsxs)(d.A,{value:e,children:[(0,o.jsx)(c.A,{checked:r.indexOf(e)>-1}),(0,o.jsx)(f.A,{primary:e})]},e))})]});return(0,o.jsx)("main",{style:{padding:32,backgroundColor:"#f8f9fa",minHeight:"100vh"},children:(0,o.jsxs)(s.A,{maxWidth:"1350",mx:"auto",children:[(0,o.jsx)(i.A,{variant:"h4",sx:{color:"#212529",fontWeight:700,mb:2},children:"Feature Progress Dashboard"}),(0,o.jsx)(i.A,{variant:"body1",sx:{color:"#6c757d",mb:4},children:"Track the progress of features (Epics/Features) based on the completion of their associated stories."}),(0,o.jsx)(X,{onManualRefresh:b,refreshing:x}),y,h&&(0,o.jsx)(V,{onTeamsUpdate:m,selectedTeams:r}),!h&&null]})})}function Q(){return(0,o.jsx)(z,{children:(0,o.jsx)(Y,{})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[294,702,935,476,710,687,9,554,441,684,358],()=>t(356)),_N_E=e.O()}]);